import{r as p,l as O,m as T,j as e,f as i,h as _,C as w,i as A}from"./index-BL1dFcbn.js";import{C as I,R as j,P as M,g as k,T as C,c as P,L as l,a as o,G as K,X,f as z,Y as D,e as h}from"./ChartContainer-MKzQ0Ycl.js";import{C as S,E as f}from"./colors-CU0AFKqM.js";import{P as G,a as Y}from"./PieChart-DIc3lDKF.js";import{C as $}from"./tooltipContext-nfTICcRa.js";import{L as E}from"./Legend-DvbsusDj.js";import{L as B,a as g}from"./LineChart-D7QijRQe.js";import{C as F,X as H,Y as U}from"./CartesianChart-DBaW1knG.js";const x=p.memo(function({label:a,value:m,colorClass:d}){return e.jsx(w,{className:"bg-slate-700/50",children:e.jsxs(A,{className:"py-2 px-3",children:[e.jsx("p",{className:"text-xs text-slate-400",children:a}),e.jsx("p",{className:`text-lg font-semibold ${d}`,children:m})]})})}),te=p.memo(function(){const{data:a,isLoading:m,error:d,refetch:v}=O(),{data:r,isLoading:R}=T(),u=m||R,L=d,c=p.useMemo(()=>a?.byType?.labels?.length?a.byType.labels.map((t,s)=>({name:t||"Unknown",value:a.byType.data?.[s]??0,color:a.byType.backgroundColor?.[s]??S[s%S.length]})):[],[a]),y=p.useMemo(()=>r?.labels?.length?r.labels.map((t,s)=>({date:t,revenue:r.revenue?.[s]??0,expenses:r.expenses?.[s]??0,profit:r.profit?.[s]??0})):[],[r]),n=a?.metrics,N=!u&&c.length===0&&y.length===0;return e.jsxs(I,{title:"Expenses & Profit",isLoading:u,error:L,onRetry:v,isEmpty:N,emptyMessage:"No expense data available",height:"md",ariaLabel:"Charts showing expense breakdown and profit analysis",children:[n&&e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[e.jsx(x,{label:"Total Expenses",value:i(n.totalExpenses??0),colorClass:"text-red-400"}),e.jsx(x,{label:"Gross Profit",value:i(n.grossProfit??0),colorClass:"text-green-400"}),e.jsx(x,{label:"Profit Margin",value:_(n.profitMargin??0),colorClass:"text-blue-400"}),e.jsx(x,{label:"Orders w/ Expenses",value:String(n.ordersWithExpenses??0),colorClass:"text-purple-400"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-400 mb-2",children:"Expenses by Type"}),e.jsx("div",{style:{height:o.height.md-32},children:e.jsx(j,{width:"100%",height:"100%",children:e.jsxs(G,{children:[e.jsx(Y,{data:c,cx:"50%",cy:"50%",innerRadius:40,outerRadius:70,dataKey:"value",nameKey:"name",label:({percent:t})=>k(t??0),...M,children:c.map((t,s)=>e.jsx($,{fill:t.color},`cell-${s}`))}),e.jsx(C,{contentStyle:P,formatter:(t,s)=>[i(Number(t)||0),String(s)]}),e.jsx(E,{...l,wrapperStyle:{...l.wrapperStyle,fontSize:"10px"},layout:"vertical",align:"right",verticalAlign:"middle"})]})})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-400 mb-2",children:"Profit Analysis"}),e.jsx("div",{style:{height:o.height.md-32},children:e.jsx(j,{width:"100%",height:"100%",children:e.jsxs(B,{data:y,margin:o.margin.default,children:[e.jsx(F,{...K}),e.jsx(H,{dataKey:"date",...X,fontSize:o.fontSize.xs}),e.jsx(U,{...D,fontSize:o.fontSize.xs,tickFormatter:z}),e.jsx(C,{contentStyle:P,formatter:(t,s)=>[i(Number(t)||0),s==="revenue"?"Revenue":s==="expenses"?"Expenses":"Profit"]}),e.jsx(E,{...l,wrapperStyle:{...l.wrapperStyle,fontSize:"11px"}}),e.jsx(g,{type:"monotone",dataKey:"revenue",name:"Revenue",stroke:f.revenue,...h}),e.jsx(g,{type:"monotone",dataKey:"expenses",name:"Expenses",stroke:f.expenses,...h}),e.jsx(g,{type:"monotone",dataKey:"profit",name:"Profit",stroke:f.profit,...h})]})})})]})]})]})});export{te as ExpensesChart};
